<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Forge - Members</title>
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Members roster for The Forge (invite-only)." />

  <link rel="stylesheet" href="./styling.css?v=1" />

  <script>
    (function () {
      try {
        const saved = localStorage.getItem("forge_theme");
        if (saved === "light" || saved === "dark") {
          document.documentElement.setAttribute("data-theme", saved);
        }
      } catch {}
    })();
  </script>
</head>

<body>
  <a href="#mainContent" class="skip-link">Skip to main content</a>

  <header>
    <nav class="nav" aria-label="Main navigation">
      <div class="brand">
        <img src="images/theforgelogo.png" alt="The Forge logo" class="brand-logo" />
        <div>
          <div class="brand-text-main">The Forge</div>
          <div class="brand-text-sub">Members</div>
        </div>
      </div>

      <!-- Desktop text navigation -->
      <div class="nav-links">
        <a href="theforge.html">Home</a>
        <a href="members.html" class="active" aria-current="page">Members</a>
        <a href="prayerrequests.html">Prayer Requests</a>
      </div>

      <div class="nav-actions">
        <!-- Theme toggle -->
        <button
          id="themeToggleDesktop"
          class="theme-toggle-btn"
          type="button"
          aria-label="Toggle theme"
          title="Toggle theme"
        >
          <span class="theme-icon theme-icon-moon">üåô</span>
          <span class="theme-icon theme-icon-sun">‚òÄÔ∏è</span>
        </button>

        <!-- Account -->
        <button id="accountButton" class="account-btn" type="button">
          <span class="icon">üë§</span>
          <span id="navAuthButtonLabel">Sign In</span>
        </button>

        <!-- MOBILE TOP ICON NAV (REPLACES HAMBURGER) -->
        <div class="mobile-top-icons" aria-label="Mobile quick navigation">
          <a href="theforge.html" class="mobile-top-icon" aria-label="Home" title="Home">
            üè†
          </a>
          <a href="members.html" class="mobile-top-icon active" aria-label="Members" title="Members">
            üë•
          </a>
          <a href="prayerrequests.html" class="mobile-top-icon" aria-label="Prayer Requests" title="Prayer Requests">
            üôè
          </a>
        </div>
      </div>
    </nav>
  </header>

  <main id="mainContent" class="shell">
    <section class="section" aria-labelledby="members-title">
      <div class="section-header">
        <div>
          <div class="section-kicker">Roster</div>
          <h1 id="members-title" class="section-title">Members of The Forge</h1>
        </div>
        <p class="section-subtitle">
          Invite-only access. Leaders and members are shown below once signed in.
        </p>
      </div>

      <div id="membersSignInPrompt" class="card">
        <h2 class="card-title">Sign In Required</h2>
        <p class="card-text">
          This roster is restricted to verified members. Use the Account button to sign in.
        </p>
        <button class="btn btn-primary" type="button" id="openAccountFromPrompt">
          <span class="icon">üîí</span><span>Open Account</span>
        </button>
      </div>

      <div id="membersWrapper" style="display:none;">
        <div class="card" style="margin-bottom: 1.25rem;">
          <h2 class="card-title">Status</h2>
          <p class="card-text" id="membersStatus">Loading members‚Ä¶</p>
        </div>

        <div class="beliefs-grid">
          <section aria-label="Leaders list">
            <h2 class="card-title">Leaders</h2>
            <div id="leadersGrid" class="members-grid"></div>
          </section>

          <section aria-label="Members list">
            <h2 class="card-title">Members</h2>
            <div id="membersGrid" class="members-grid"></div>
          </section>
        </div>
      </div>

      <p class="auth-footnote" style="margin-top: 1rem;">
        <span id="authStatus">Not signed in</span>
      </p>
    </section>

    <footer>
      <div>¬© <span id="year"></span> The Forge ¬∑ ESTD 2025</div>
      <div>
        For access questions, email
        <a href="mailto:theforgetncommunity@gmail.com">theforgetncommunity@gmail.com</a>.
      </div>
    </footer>
  </main>

  <!-- AUTH MODAL -->
  <div class="auth-overlay" id="authOverlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="auth-card">
      <button type="button" class="auth-close-btn" id="authCloseBtn" aria-label="Close account window">‚úï</button>

      <div class="auth-card-inner">
        <div class="auth-card-header">
          <div class="auth-card-title">Forge Account</div>
          <div class="auth-card-sub">
            Invite-only access. Use the code you were given by the group owner.
          </div>
        </div>

        <div class="auth-toggle-row">
          <button type="button" class="auth-toggle-btn active" data-mode="signin">Sign In</button>
          <button type="button" class="auth-toggle-btn" data-mode="signup">Create Account</button>
        </div>

        <form id="loginForm" class="auth-form">
          <div class="auth-field">
            <label class="auth-label" for="loginEmail">Email</label>
            <input id="loginEmail" type="email" class="auth-input" required />
          </div>

          <div class="auth-field">
            <label class="auth-label" for="loginPassword">Password</label>
            <input id="loginPassword" type="password" class="auth-input" required />
          </div>

          <a href="#" id="forgotPasswordLink" class="forgot-password-link">Forgot password?</a>

          <button type="submit" class="auth-btn">Sign In</button>
          <div class="auth-error" id="authErrorLogin"></div>
        </form>

        <form id="signupForm" class="auth-form" style="display:none;">
          <div class="auth-field">
            <label class="auth-label" for="signupFirstName">First Name</label>
            <input id="signupFirstName" type="text" class="auth-input" required />
          </div>

          <div class="auth-field">
            <label class="auth-label" for="signupLastName">Last Name</label>
            <input id="signupLastName" type="text" class="auth-input" required />
          </div>

          <input id="signupName" type="hidden" />

          <div class="auth-field">
            <label class="auth-label" for="signupEmail">Email</label>
            <input id="signupEmail" type="email" class="auth-input" required />
          </div>

          <div class="auth-field">
            <label class="auth-label" for="signupPassword">Password</label>
            <input id="signupPassword" type="password" class="auth-input" required />
          </div>

          <div class="auth-field">
            <label class="auth-label" for="signupPassword2">Confirm Password</label>
            <input id="signupPassword2" type="password" class="auth-input" required />
          </div>

          <div class="auth-field">
            <label class="auth-label" for="signupInvite">Invite Code</label>
            <input id="signupInvite" type="text" class="auth-input" required />
          </div>

          <button type="submit" class="auth-btn">Create Account</button>
          <div class="auth-error" id="authErrorSignup"></div>
        </form>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
    const promptBtn = document.getElementById("openAccountFromPrompt");
    if (promptBtn) {
      promptBtn.addEventListener("click", () => {
        document.getElementById("accountButton").click();
      });
    }
  </script>

  <script src="theme.js"></script>
  <script src="a11y.js"></script>
  <script type="module" src="auth.js"></script>
</body>
</html>
